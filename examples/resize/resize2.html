<!DOCTYPE html>
<html>
	<head>
		<title> Argure Demo: Image Resizing </title>
		<script src="../../spec/vendor/jquery-1.6.js"></script>
		<script src="../../spec/vendor/jquery.tmpl.js"></script>
		<script src="../../spec/vendor/knockout-1.2.1.debug.js"></script>
		<script src="../../public/javascripts/argure.js"></script>
	</head>
	<body>
		<h1>
		Resize Image	
		</h1>
		<div id="resizeArgure">
			<form id="resize">

				<p>Initial Height: <span data-bind="text: initHeight"></span></p>
				<p>Initial Width: <span data-bind="text: initWidth"></span></p>

				<label for="absHeight">Absolute Height</label>
				<input type="text" id="absHeight" data-bind="value: absHeight"/>
				<span data-bind="text: absHeight.priority"></span>
				<br />
				<label for="relHeight">Relative Height</label>
				<input type="text" id="relHeight" data-bind="value: relHeight"/>
				<span data-bind="text: relHeight.priority"></span>
				<br />
				<label for="absWidth">Absolute Width</label>
				<input type="text" id="absWidth" data-bind="value: absWidth"/>
				<span data-bind="text: absWidth.priority"></span>
				<br />
				<label for="relWidth">Relative Width</label>
				<input type="text" id="relWidth" data-bind="value: relWidth"/>
				<span data-bind="text: relWidth.priority"></span>
				<br />
				<label for="ratio">Lock Ratio</label>
				<input type="checkbox" id="ratio" data-bind="checked: ratio"/>
				<span data-bind="text: ratio.priority"></span>

			</form>

			<script type="text/coffeescript" charset="utf-8">
				class Resizer extends Argure.Model
					constructor: (@initHeight, @initWidth) ->
						super()
					@observe 'absHeight'
					@observe 'relHeight', initial: 100
					@observe 'absWidth'
					@observe 'relWidth', initial: 100
					@observe 'ratio', initial: false
					
					@relate (c) ->
						c.method absHeight: ['relHeight', 'initHeight'], (r, i) -> (r / 100.0 * i)
						c.method relHeight: ['absHeight', 'initHeight'], (a, i) -> (a / i) * 100.0

					@relate (c) ->
						c.method absWidth: ['relWidth', 'initWidth'], (r, i) -> (r / 100.0 * i)
						c.method relWidth: ['absWidth', 'initWidth'], (a, i) -> (a / i) * 100.0

					@relate (c) ->
						c.method relWidth: ['relHeight', 'relWidth', 'ratio'], (h, w, r) ->
							h
						, (h, w, r) -> r
						c.method relHeight: ['relHeight', 'relWidth', 'ratio'], (h, w, r) -> 
							w
						, (h, w, r) -> r
	
				this.resizer = new Resizer(1000, 1000)
				ko.applyBindings(this.resizer)
			</script>
							
		</div>
	</body>
</html>
